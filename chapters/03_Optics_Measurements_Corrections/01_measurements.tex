\section{\review{Optics Measurements}}

To perform optics measurements, several tools and techniques are used. This section details the
various implemented methods to measure specific observables.

% ===============================
%            Software
% ===============================
\subsection{\review{Tools and Softwares}}

In order to perform the measurements, analysis and simulations presented in this thesis, various
tools and softwares have been developed, used and contributed to.

Optics simulations have been done mainly in MAD-X~\cite{deniau_mad-x_nodate} and PTC.
MAD-NG~\cite{deniau_mad-ng_2020} and
Xsuite~\cite{g_iadarola_xsuite_nodate} have also been explored for specific tasks such as free RDT
simulations and GPU tracking.

Analysis of chromaticity measurements are done via a newly developed graphical
interface~\cite{m_le_garrec_non-linear_2022} written in Python. This tool makes cleaning of the raw
signal data, its analysis and results export more reliable and easier.

Overall, analysis of turn-by-turn measurements is supported by a large panel of libraries written by
the OMC team in Python and Java. Contributions have mainly been made to extend the following
packages:


\begin{itemize}
    \item \textbf{Beta-Beat GUI}~\cite{omc-team_beta-beat_2008}, Graphical interface for
    turn-by-turn measurements visualization and analysis.
    \item \textbf{OMC3}~\cite{omc-team_omc3_2021}, Main optics analysis and corrections software.
    \item \textbf{Beta-Beat.src}~\cite{omc-team_beta-beatsrc_2018}, Old analysis software, now
    replaced by OMC3.
    \item \textbf{pylhc.github.io}~\cite{omc-team_omc_2020}, Website of the OMC team with package
    documentation, examples and useful resources.
\end{itemize}


% ===============================
%           TbT Data
% ===============================
\subsection{\review{Turn-by-Turn Data}}

Data is typically acquired turn by turn while exciting the beam with an AC-Dipole. This is usually
done with a \textit{pilot bunch}, with a reduced intensity of $10^{10}$ protons compared to
an operation bunch of $10^{11}$. This allow for higher amplitude oscillations while remaining safe 
for the machine.

A spectral analysis is then performed via a \textit{FFT}, making apparent the driven tunes from the 
AC-Dipole, the transverse tunes and the possible resonance lines, as shown in
\cref{fig:optics_measurements:tbt_data:spectrum}.

\begin{figure}[!htb]
    \centering
    \includegraphics[width=0.8\textwidth]{./images/basic_spectrum.pdf}
    \caption{Horizontal frequency spectrum of a turn-by-turn measurement in the LHC. The 
    \textit{driven} tunes of the AC-Dipoles have the highest amplitudes while the natural tune can
    be seen close to it. Other lines are often created by resonances.}
    \label{fig:optics_measurements:tbt_data:spectrum}
\end{figure}

From this, the \textit{optics} such as $\beta$-beating, dispersion, coupling and Resonance Driving
Terms can be reconstructed~\cite{catalan-lasheras_linear_2004}, as will be detailed in the following
sections.

\FloatBarrier

% ===============================
%         Beta Beating
% ===============================
\subsection{\todo{$\beta$-Beating}}
\subsection{\todo{Dispersion}}
\subsection{\todo{Action}}
\subsection{\todo{Coupling}}
\subsection{\todo{Amplitude Detuning}}
\subsection{\todo{Lifetime}}
\subsection{\todo{Resonance Driving Terms}}



% ===============================
%          Chromaticity
% ===============================
\subsection{\review{Chromaticity}}
\label{subsection:optics_corrections_chromaticity}

%% --- Procedure ---
%\subsubsection{\review{Procedure}}

Chromaticity measurements are typically performed by varying the RF frequency to induce a change of
momentum offset $\delta$, while measuring the tune. The momentum offset $\delta$ being related to
the RF frequency, the Lorentz factor $\gamma$ and the momentum compaction factor
$\alpha_c$~\cite{keintzel_jacqueline_beam_nodate}:

\begin{equation}
    \delta = - \left(\frac{1}{\gamma^{-2} + \alpha_c}\right) \cdot \frac{\Delta f_{\text{RF}}}{f_{\text{RF,nominal}}}
    \label{eq:dpp_rf}
\end{equation}

In the LHC, the Lorentz factor $\gamma^{-2}$ is here negligible, as the energy is large even at
injection.  At 450GeV, $\gamma^{-2} \approx 10^{-6}$, which is two orders of magnitude smaller than
$\alpha_c$.

During operation, where the linear chromaticity often needs to be measured, a sinusoid function is
applied on the RF frequency. This induces a short range of momentum offset, but enough to measure
the first order of the chromaticity function.
For non-linear measurements, a larger range is required. In order to do so, a new procedure has been
developed. Dense frequency scans with steps of 20Hz every 30 seconds are usually taken to compromise
between number of data points, precision of the tune estimate, and duration of the measurement. Once
beam losses, registered by the BLMs are deemed too high, the frequency is reverted back to its
nominal value in larger steps. Attaining the limits of the BLMs ensures a large momentum-offset
range. The same procedure is then re-applied in the negative. \Cref{fig:measurements:rf_scan} shows
a typical RF scan performed to measure chromaticity in the LHC.

\begin{figure}[H]
    \centering
    \includegraphics[width=1\textwidth]{images/rf_scan.pdf}
    \caption{Observation of the tune dependence on momentum offset, created by a shift of RF
             frequency.}
    \label{fig:measurements:rf_scan}
\end{figure}


%% --- Analysis and Fit ---
%\subsubsection{\review{Analysis}}

Once the tunes have been acquired and the momentum offset computed via \cref{eq:dpp_rf}, the
chromaticity function (see \cref{eq:background_chromaticity}) can be used to fit the
measured data and retrieve each order.

As part of the work for this thesis, a new tool, was developed. in order to ease and improve the
analysis of chromaticity measurements. 
The Non-Linear Chromaticity GUI~\cite{m_le_garrec_non-linear_2022} showcases new analysis techniques
using the raw signal from the BBQ system along with custom signal cleaning that are detailed later
on in \cref{chapter:high_order_fields}. Fits to very high chromaticity orders are also now possible
along with their computed corrections and that of resonance driving terms via a combined response
matrix approach. Automatic data extraction from the CERN data servers (Timber, NXCALS) is also
included.